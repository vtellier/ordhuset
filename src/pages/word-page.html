<!--<link rel="import" href="../ordhuset-app/oh-behavior.html">-->
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../ordhuset-app/shared-style.html">
<link rel="import" href="../components/oh-substantive-list-editor.html">

<dom-module id="word-page">
  <template>
    <style include="shared-styles">
      :host {
        /*display: block;
        padding: 10px;*/
      }

      .substantive-button-box {
        margin-top: 20px;
        text-align: center;
      }
      .substantive-button-box paper-fab {
        display: inline-block;
        margin-left: 1ex;
      }

      table.subs-list {
        width: 100%;
      }
    </style>

    <firebase-document
        id="wordDocument"
        app-name="ordhuset"
        path="/norwegian/[[norwegian]]"
        data="{{editableWord}}">
    </firebase-document>

    <firebase-query
        id="substantivesQuery"
        app-name="ordhuset"
        path="/substantives/[[norwegian]]"
        data="{{currentSubstantives}}">
    </firebase-query>

    <div class="card">
      <h2>[[norwegian]]</h2>
      <p>This word has [[currentSubstantives.length]] subtantives.</p>
      <p>adminMode is [[adminMode]]</p>
    </div>

    <div class="card">
      <h3>Substantives</h3>

      <!-- administrator only -->
      <template is="dom-if" if="[[adminMode]]">
        <oh-substantive-list-editor norwegian="[[norwegian]]">
        </oh-substantive-list-editor>
      </template>

      <!-- read only -->
      <template is="dom-if" if="{{!adminMode}}">
        <table class="subs-list">
          <thead>
            <th>Gender</th>
            <th>Singular indefinite</th>
            <th>Singular definite</th>
            <th>Plural indefinite</th>
            <th>Plural definite</th>
          </thead>
          <template is="dom-repeat" items="[[currentSubstantives]]" as="substantive" indexAs="index">
            <tr>
              <td>[[substantive.gender]]</td>
              <td>[[norwegian]]</td>
              <td>[[substantive.singularDefinite]]</td>
              <td>[[substantive.pluralIndefinite]]</td>
              <td>[[substantive.pluralDefinite]]</td>
            </tr>
          </template>
        </table>
      </template>
    </div>

  </template>

  <script>
    Polymer({
      is: 'word-page',
      behaviors: [Polymer.OrdhusetBehavior],

      properties: {
        subroute: Object,
        norwegian: {
          type: String,
          notify: true,
          computed: 'stripFirstSlash(subroute.path)'
        },
        word: {
          type: Object,
          notify: true,
          //observer: 'dataChanged'
        },
        currentSubstantives: {
          type: Object,
        },
        newSubstantive: {
          type: Object,
          notify: true,
          value: {
            '$key': '',
            'opened': false
          },
        }
      },

    });
  </script>
</dom-module>